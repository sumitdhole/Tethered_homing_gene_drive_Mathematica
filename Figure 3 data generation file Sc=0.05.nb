(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     35806,        837]
NotebookOptionsPosition[     35103,        806]
NotebookOutlinePosition[     35481,        823]
CellTagsIndexPosition[     35438,        820]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Loop", "Section",
 CellChangeTimes->{{3.706356314635099*^9, 3.706356314753977*^9}, {
  3.706358874733233*^9, 3.706358875677567*^9}}],

Cell[BoxData[
 RowBox[{"Loop", ":=", 
  RowBox[{"(", 
   RowBox[{"For", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{"AlleleFreqA", ",", "Nloci"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AlleleFreqA", "[", "i", "]"}], "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "Nloci"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TotalLoadA", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AUC1A", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AUC2A", "=", "IntroFreq1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AUC3A", "=", "IntroFreq1"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"DiploidFitnessTable", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "NHaplotypes"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "NHaplotypes"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"BitGet", "[", 
              RowBox[{
               RowBox[{"BitOr", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", 
                 RowBox[{"j", "-", "1"}]}], "]"}], ",", "1"}], "]"}], "-", 
             RowBox[{"BitGet", "[", 
              RowBox[{
               RowBox[{"BitOr", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", 
                 RowBox[{"j", "-", "1"}]}], "]"}], ",", "2"}], "]"}]}], "==", 
            " ", "0"}], ",", 
           RowBox[{
            RowBox[{"DiploidFitnessTable", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "*=", "1"}], ",", 
           RowBox[{
            RowBox[{"DiploidFitnessTable", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "*=", "tox"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"BitGet", "[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "+", 
             RowBox[{"BitGet", "[", 
              RowBox[{
               RowBox[{"j", "-", "1"}], ",", "1"}], "]"}]}], "\[Equal]", 
            "1"}], ",", 
           RowBox[{
            RowBox[{"DiploidFitnessTable", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "*=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "sc"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}]}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"BitGet", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "+", 
               RowBox[{"BitGet", "[", 
                RowBox[{
                 RowBox[{"j", "-", "1"}], ",", "1"}], "]"}]}], "\[Equal]", 
              "2"}], ",", 
             RowBox[{
              RowBox[{"DiploidFitnessTable", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "*=", 
              RowBox[{"(", 
               RowBox[{"1", "-", "sc"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"DiploidFitnessTable", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "*=", "1"}]}], "]"}]}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NHaplotypes"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "NHaplotypes"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"BitGet", "[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "+", 
             RowBox[{"BitGet", "[", 
              RowBox[{
               RowBox[{"j", "-", "1"}], ",", "1"}], "]"}]}], ")"}], ">", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"BitGet", "[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", "0"}], "]"}], "+", 
              RowBox[{"BitGet", "[", 
               RowBox[{
                RowBox[{"j", "-", "1"}], ",", "0"}], "]"}]}], "\[Equal]", 
             "1"}], ",", 
            RowBox[{
             RowBox[{"DiploidFitnessTable", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "*=", "h1"}]}], "]"}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NHaplotypes"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "NHaplotypes"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ViabilitySelection", "=", "DiploidFitnessTable"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"BitGet", "[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", "0"}], "]"}], "+", 
             RowBox[{"BitGet", "[", 
              RowBox[{
               RowBox[{"j", "-", "1"}], ",", "0"}], "]"}]}], ")"}], 
           "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"ViabilitySelection", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "*=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "sp"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"BitGet", "[", 
                RowBox[{
                 RowBox[{"i", "-", "1"}], ",", "0"}], "]"}], "+", 
               RowBox[{"BitGet", "[", 
                RowBox[{
                 RowBox[{"j", "-", "1"}], ",", "0"}], "]"}]}], ")"}], 
             "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{"ViabilitySelection", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "*=", 
             RowBox[{"(", 
              RowBox[{"1", "-", "sp"}], ")"}]}]}], "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NHaplotypes"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "NHaplotypes"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"g", "=", "0"}]}], ",", 
     RowBox[{"g", "<", 
      RowBox[{"Generations", "+", "1"}]}], ",", 
     RowBox[{"g", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GenoFreqSelecA", "=", 
       RowBox[{"GenoFreqA", "*", 
        RowBox[{"ViabilitySelection", "/", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"GenoFreqA", "*", "ViabilitySelection"}], ",", "2"}], 
          "]"}]}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TotalLoadt1A", "=", 
       RowBox[{"1", "-", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"GenoFreqA", "*", "ViabilitySelection"}], ",", "2"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"g", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"GenoFreqSelecA", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
          RowBox[{"1", "-", "IntroFreq1", "-", "IntroFreq2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"GenoFreqSelecA", "[", 
           RowBox[{"[", 
            RowBox[{"7", ",", "7"}], "]"}], "]"}], "=", "IntroFreq1"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"GenoFreqSelecA", "[", 
           RowBox[{"[", 
            RowBox[{"NHaplotypes", ",", "NHaplotypes"}], "]"}], "]"}], "=", 
          "IntroFreq2"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"k", "=", "i"}], ";", 
         RowBox[{"l", "=", "j"}], ";", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"BitGet", "[", 
             RowBox[{
              RowBox[{"BitOr", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", "1"}], "]"}], "\[Equal]", 
            "1"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"BitGet", "[", 
                 RowBox[{"i", ",", "0"}], "]"}], "+", 
                RowBox[{"BitGet", "[", 
                 RowBox[{"j", ",", "0"}], "]"}]}], ")"}], "\[Equal]", "1"}], 
             ",", 
             RowBox[{
              RowBox[{"k", "=", 
               RowBox[{"BitSet", "[", 
                RowBox[{"k", ",", "0"}], "]"}]}], ";", 
              RowBox[{"l", "=", 
               RowBox[{"BitSet", "[", 
                RowBox[{"l", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"GenoFreqSelecA", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"k", "+", "1"}], ",", 
                  RowBox[{"l", "+", "1"}]}], "]"}], "]"}], "+=", 
               RowBox[{"GenoFreqSelecA", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", 
                  RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ";", 
              RowBox[{
               RowBox[{"GenoFreqSelecA", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "+", "1"}], ",", 
                  RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", "0"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"NHaplotypes", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", 
          RowBox[{"NHaplotypes", "-", "1"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"MaskProb", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mask", ",", "Nloci"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"prob", "=", "1.0"}], ";", 
            RowBox[{"z", "=", "1"}]}], ",", " ", 
           RowBox[{"z", "<", "Nloci"}], ",", 
           RowBox[{"z", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"BitGet", "[", 
               RowBox[{"mask", ",", 
                RowBox[{"(", 
                 RowBox[{"Nloci", "-", "z"}], ")"}]}], "]"}], "==", 
              RowBox[{"BitGet", "[", 
               RowBox[{"mask", ",", 
                RowBox[{"(", 
                 RowBox[{"Nloci", "-", "z", "-", "1"}], ")"}]}], "]"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"prob", "*=", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"recrate", "[", "z", "]"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"prob", "*=", 
              RowBox[{"recrate", "[", "z", "]"}]}]}], "]"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ZygoteGenotypes", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "mask"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zyg1", "=", "0"}], ";", 
            RowBox[{"zyg2", "=", "0"}], ";", 
            RowBox[{"k", "=", "0"}]}], ",", 
           RowBox[{"k", "<", "Nloci"}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"BitGet", "[", 
               RowBox[{"mask", ",", "k"}], "]"}], "\[Equal]", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"zyg1", "=", 
               RowBox[{"BitOr", "[", 
                RowBox[{"zyg1", ",", 
                 RowBox[{"(", 
                  RowBox[{"BitAnd", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{"2", "^", "k"}], ")"}]}], "]"}], ")"}]}], "]"}]}],
               ";", 
              RowBox[{"zyg2", "=", 
               RowBox[{"BitOr", "[", 
                RowBox[{"zyg2", ",", 
                 RowBox[{"(", 
                  RowBox[{"BitAnd", "[", 
                   RowBox[{"j", ",", 
                    RowBox[{"(", 
                    RowBox[{"2", "^", "k"}], ")"}]}], "]"}], ")"}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"zyg1", "=", 
               RowBox[{"BitOr", "[", 
                RowBox[{"zyg1", ",", 
                 RowBox[{"(", 
                  RowBox[{"BitAnd", "[", 
                   RowBox[{"j", ",", 
                    RowBox[{"(", 
                    RowBox[{"2", "^", "k"}], ")"}]}], "]"}], ")"}]}], "]"}]}],
               ";", 
              RowBox[{"zyg2", "=", 
               RowBox[{"BitOr", "[", 
                RowBox[{"zyg2", ",", 
                 RowBox[{"(", 
                  RowBox[{"BitAnd", "[", 
                   RowBox[{"i", ",", 
                    RowBox[{"(", 
                    RowBox[{"2", "^", "k"}], ")"}]}], "]"}], ")"}]}], 
                "]"}]}]}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"RecTable", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "NHaplotypes"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "NHaplotypes"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "NHaplotypes"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "<", "NHaplotypes"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "0"}], ",", 
          RowBox[{"j", "<", "NHaplotypes"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"mask", "=", "0"}], ",", 
            RowBox[{"mask", "<", "masklim"}], ",", 
            RowBox[{"mask", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MaskProb", "[", 
              RowBox[{"mask", ",", "Nloci"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"zygoteProb", " ", "=", 
              RowBox[{"0.5", "*", "prob"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"ZygoteGenotypes", "[", 
              RowBox[{"i", ",", "j", ",", "mask"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"RecTable", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"j", "+", "1"}], ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"zyg1", "+", "1"}], ")"}]}], "]"}], "]"}], "+=", 
              "zygoteProb"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"RecTable", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"j", "+", "1"}], ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"zyg2", "+", "1"}], ")"}]}], "]"}], "]"}], "+=", 
              "zygoteProb"}], ";"}]}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"GameteTableA", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "NHaplotypes"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "NHaplotypes"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "NHaplotypes"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", 
         RowBox[{"(", 
          RowBox[{"NHaplotypes", "+", "1"}], ")"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "<", 
           RowBox[{"(", 
            RowBox[{"NHaplotypes", "+", "1"}], ")"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "<", 
             RowBox[{"(", 
              RowBox[{"NHaplotypes", "+", "1"}], ")"}]}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"GameteTableA", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"RecTable", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "*", 
              RowBox[{"GenoFreqSelecA", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}]}], "]"}]}], "]"}]}],
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"HaploFreqt1A", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"GameteTableA", ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"HaploFreqA", "=", 
       RowBox[{"HaploFreqt1A", "/", 
        RowBox[{"(", 
         RowBox[{"Total", "[", "HaploFreqt1A", "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"GenoFreqT1A", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "NHaplotypes"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "NHaplotypes"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"GenoFreqT1A", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"HaploFreqA", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"HaploFreqA", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NHaplotypes"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "NHaplotypes"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"GenoFreqA", "=", "GenoFreqT1A"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AlleleFreqT1A", "[", "i", "]"}], "=", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "Nloci"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BitGet", "[", 
            RowBox[{
             RowBox[{"j", "-", "1"}], ",", 
             RowBox[{"i", "-", "1"}]}], "]"}], "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"AlleleFreqT1A", "[", "i", "]"}], "+=", 
           RowBox[{"HaploFreqA", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "Nloci"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "NHaplotypes"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"AlleleFreqA", "[", "i", "]"}], ",", 
          RowBox[{"AlleleFreqT1A", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AUC1A", "+=", 
       RowBox[{"AlleleFreqT1A", "[", "1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AUC2A", "+=", 
       RowBox[{"AlleleFreqT1A", "[", "2", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AUC3A", "+=", 
       RowBox[{"AlleleFreqT1A", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"TotalLoadA", ",", "TotalLoadt1A"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"g", "\[Equal]", "Generations"}], ",", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"Datatable", ",", 
           RowBox[{"{", 
            RowBox[{"IntroFreqTotal", ",", "sp", ",", "sc", ",", 
             RowBox[{"AUC1A", "/", "Generations"}], ",", 
             RowBox[{"AUC2A", "/", "Generations"}], ",", 
             RowBox[{"AUC3A", "/", "Generations"}], ",", 
             RowBox[{"Mean", "[", 
              RowBox[{"TotalLoadA", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "20"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"AlleleFreqT1A", "[", "1", "]"}], ",", 
             RowBox[{"AlleleFreqT1A", "[", "2", "]"}], ",", 
             RowBox[{"AlleleFreqT1A", "[", "3", "]"}], ",", "IntroFreq2", ",",
              "thresh", ",", "g"}], "}"}]}], "]"}], ";", 
         RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.679195238472766*^9, 3.679195290229185*^9}, {
   3.679195336664768*^9, 3.679195364804172*^9}, {3.679195399802265*^9, 
   3.6791954158717203`*^9}, {3.679195461705997*^9, 3.679195485646923*^9}, {
   3.679195527714764*^9, 3.679195573368829*^9}, {3.679195922475966*^9, 
   3.6791959420168858`*^9}, {3.679196105912516*^9, 3.679196151384348*^9}, 
   3.6791968975579*^9, {3.6791969319483957`*^9, 3.679197162887766*^9}, {
   3.679197381534028*^9, 3.679197390339229*^9}, {3.679197458864303*^9, 
   3.679197466864097*^9}, {3.67919750371981*^9, 3.679197585209832*^9}, {
   3.679197624402258*^9, 3.679197637729237*^9}, {3.679203568449382*^9, 
   3.679203603294393*^9}, {3.679205890420905*^9, 3.679205938473055*^9}, {
   3.679205984887636*^9, 3.6792059997742968`*^9}, {3.679206116320804*^9, 
   3.679206161186357*^9}, {3.6794081754537582`*^9, 3.67940820625259*^9}, {
   3.67940853442587*^9, 3.679408593057382*^9}, {3.679408640898909*^9, 
   3.679408664470084*^9}, {3.679409901930099*^9, 3.679409905953642*^9}, {
   3.6794099415651407`*^9, 3.679409945703527*^9}, {3.6794108201570263`*^9, 
   3.679410827278801*^9}, {3.6794109072626867`*^9, 3.679410909088386*^9}, {
   3.679411062180499*^9, 3.6794110635418367`*^9}, 3.679411420882893*^9, {
   3.6794134551771927`*^9, 3.679413485654039*^9}, {3.679417992537286*^9, 
   3.679418016576469*^9}, {3.679418979414535*^9, 3.679419002529429*^9}, 
   3.6794190354189043`*^9, {3.679419093475958*^9, 3.6794190952522783`*^9}, 
   3.679419314246674*^9, {3.679420151149292*^9, 3.6794202033892593`*^9}, {
   3.67942034425703*^9, 3.67942034793606*^9}, {3.6802755203304996`*^9, 
   3.680275533702771*^9}, {3.680275661218587*^9, 3.680275672082404*^9}, {
   3.680275716098983*^9, 3.680275777232111*^9}, {3.680275810228286*^9, 
   3.6802758371735086`*^9}, {3.680275970468361*^9, 3.680275985669724*^9}, {
   3.68027603950838*^9, 3.6802762207545023`*^9}, {3.680276319399047*^9, 
   3.680276343802533*^9}, {3.68027652876575*^9, 3.680276571327035*^9}, {
   3.6802808768856087`*^9, 3.68028089020971*^9}, {3.6804463306191597`*^9, 
   3.680446357864223*^9}, {3.680446433914899*^9, 3.680446434859243*^9}, 
   3.680451722932249*^9, 3.680451782047534*^9, {3.680527357659811*^9, 
   3.680527383919874*^9}, {3.68052743098487*^9, 3.6805275629570312`*^9}, {
   3.680529091920483*^9, 3.680529207891753*^9}, {3.6805292412962303`*^9, 
   3.680529314012001*^9}, {3.680529528595521*^9, 3.680529642081966*^9}, {
   3.680529702386009*^9, 3.6805297041179953`*^9}, {3.6805299730348663`*^9, 
   3.680530165293159*^9}, 3.680530203329508*^9, 3.680530530177824*^9, {
   3.680531238824839*^9, 3.6805313134750967`*^9}, {3.685794032795508*^9, 
   3.685794059434601*^9}, {3.685794993262554*^9, 3.6857950087355003`*^9}, {
   3.706017315979739*^9, 3.706017317278326*^9}, {3.706459555547915*^9, 
   3.7064596622317753`*^9}, {3.7064597298076363`*^9, 3.706459797941312*^9}, {
   3.706459838298028*^9, 3.706459839260426*^9}, {3.7064598728889008`*^9, 
   3.706459933052991*^9}, {3.706460034187798*^9, 3.706460069432794*^9}, {
   3.706460165317977*^9, 3.706460216362954*^9}, {3.70646024707236*^9, 
   3.706460274915008*^9}, {3.7064608147085657`*^9, 3.706460819682741*^9}, {
   3.70653500658225*^9, 3.706535106718749*^9}, {3.706535685218553*^9, 
   3.706535686706091*^9}, {3.706535827169779*^9, 3.706535847759598*^9}, {
   3.706535943348639*^9, 3.706535960812687*^9}, {3.706536013035098*^9, 
   3.7065360508136*^9}, 3.706536103634667*^9, {3.706536202854046*^9, 
   3.706536204223467*^9}, {3.706536367690576*^9, 3.706536370858468*^9}, {
   3.706537708432835*^9, 3.706537713128149*^9}, {3.7065377614369297`*^9, 
   3.70653776228393*^9}, {3.707489181459017*^9, 3.707489186768393*^9}, {
   3.708781814554151*^9, 3.708781835880801*^9}, {3.708781997569055*^9, 
   3.708781998607671*^9}, {3.708782036534603*^9, 3.708782064780946*^9}, {
   3.7087821449613256`*^9, 3.708782145210593*^9}, {3.708782460398881*^9, 
   3.708782485291217*^9}, {3.708854434978569*^9, 3.708854487410966*^9}, {
   3.7105144006322412`*^9, 3.7105144718086147`*^9}, {3.7105145171138144`*^9, 
   3.7105146549031973`*^9}, {3.710514802124646*^9, 3.7105148027390003`*^9}, {
   3.715595624631139*^9, 3.715595626547543*^9}, {3.715963557749412*^9, 
   3.715963559715043*^9}, {3.71604891912027*^9, 3.7160490370031013`*^9}, {
   3.716050549277989*^9, 3.716050760534457*^9}, 3.716050810275444*^9, {
   3.71605096949269*^9, 3.716051011968799*^9}, 3.716052480602376*^9, 
   3.716052587628186*^9, {3.716053037859736*^9, 3.716053038232909*^9}, 
   3.716730640802474*^9, {3.716730728141982*^9, 3.716730735428404*^9}, 
   3.716911289442234*^9, 3.718033200549223*^9, {3.718033306630571*^9, 
   3.718033313576807*^9}, {3.718033423068983*^9, 3.7180335045972357`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initiation", "Section",
 CellChangeTimes->{{3.6781037605579348`*^9, 3.678103762621704*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Nloci", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NGenotypes", "=", 
   RowBox[{"3", "^", "Nloci"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NHaplotypes", "=", 
   RowBox[{"2", "^", "Nloci"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"recrate", "[", "1", "]"}], "=", "0.5"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recrate", "[", "2", "]"}], "=", "0.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"masklim", "=", 
   RowBox[{"2", "^", 
    RowBox[{"(", 
     RowBox[{"Nloci", "-", "1"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tox", "=", "0"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "this", " ", "describes", " ", "the", " ", "level", " ", "of", " ", 
     "toxicity", " ", "for", " ", "the", " ", "underdominance", " ", 
     RowBox[{"toxins", ".", " ", "1"}], " ", "is", " ", "no", " ", "effect", 
     " ", "on", " ", "fitness"}], ",", " ", 
    RowBox[{"0", " ", "is", " ", "complete", " ", "lethality"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"thresh", "=."}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Generations", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h1", "=", ".95"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sc", "=", "0.05"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntroFreq2", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntroFreq1", "=", 
   RowBox[{"IntroFreqTotal", "-", "IntroFreq2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7064601157432747`*^9, 3.706460117056748*^9}, 
   3.7064603103768873`*^9, {3.706460375324242*^9, 3.706460419919759*^9}, {
   3.7064605052143087`*^9, 3.7064605384854317`*^9}, {3.706460726954247*^9, 
   3.7064607896177073`*^9}, {3.70646082463488*^9, 3.706460843084364*^9}, {
   3.706460888890106*^9, 3.706460967884873*^9}, {3.706461436804995*^9, 
   3.7064614451512547`*^9}, {3.7064615121284857`*^9, 3.706461512297574*^9}, {
   3.706535176363162*^9, 3.706535217679399*^9}, {3.706535301366064*^9, 
   3.7065353026225157`*^9}, {3.706535472402338*^9, 3.7065354859270353`*^9}, {
   3.706535525558207*^9, 3.706535536563599*^9}, {3.70653560332267*^9, 
   3.706535634075224*^9}, {3.7065377357329683`*^9, 3.706537740976265*^9}, {
   3.706537803942472*^9, 3.706537865460424*^9}, 3.706537927561864*^9, 
   3.706539758824284*^9, {3.707489261662257*^9, 3.707489280694557*^9}, {
   3.707489348811039*^9, 3.707489350065235*^9}, {3.7074894084360743`*^9, 
   3.7074894093075657`*^9}, {3.707489448749621*^9, 3.707489466021813*^9}, {
   3.70748952104996*^9, 3.707489546665073*^9}, {3.707489588949793*^9, 
   3.7074896956637897`*^9}, 3.707490026325988*^9, {3.70749520880343*^9, 
   3.7074952104646263`*^9}, {3.7074965493348703`*^9, 3.707496577567582*^9}, 
   3.707496730910432*^9, 3.708781211600154*^9, {3.708781688325067*^9, 
   3.708781755530476*^9}, {3.708782717982037*^9, 3.7087827343131323`*^9}, {
   3.708854508379426*^9, 3.708854511637969*^9}, 3.70885454221684*^9, {
   3.708854582493267*^9, 3.70885458258488*^9}, {3.7088546292930202`*^9, 
   3.708854630458148*^9}, {3.709305900479694*^9, 3.709305900973686*^9}, {
   3.709480413048992*^9, 3.7094804395053177`*^9}, {3.709480810019176*^9, 
   3.709480810225251*^9}, {3.709481139474268*^9, 3.7094811576973457`*^9}, {
   3.709481191803465*^9, 3.709481192953494*^9}, {3.709481226059931*^9, 
   3.709481269668872*^9}, {3.710514840237307*^9, 3.7105148768301907`*^9}, {
   3.71051495658432*^9, 3.7105149766101847`*^9}, 3.710516055718498*^9, {
   3.710519877252586*^9, 3.7105198786440268`*^9}, {3.710678673680389*^9, 
   3.7106786892476273`*^9}, {3.710679641315548*^9, 3.7106796517857857`*^9}, {
   3.710679761413549*^9, 3.710679762148131*^9}, {3.710679799729206*^9, 
   3.710679800206283*^9}, {3.710679865863985*^9, 3.710679870910281*^9}, {
   3.710679906446744*^9, 3.7106799069683943`*^9}, {3.7107702888227177`*^9, 
   3.7107703016596727`*^9}, {3.710770411778248*^9, 3.7107704124328747`*^9}, {
   3.710770442685006*^9, 3.710770451049547*^9}, {3.710770501580153*^9, 
   3.71077050220532*^9}, {3.710770552789476*^9, 3.710770553192842*^9}, {
   3.710770669309176*^9, 3.71077067264143*^9}, {3.71077071589027*^9, 
   3.710770725140833*^9}, {3.715596464973418*^9, 3.7155964650878143`*^9}, {
   3.715596513520576*^9, 3.71559652794409*^9}, {3.715596561280239*^9, 
   3.715596664716707*^9}, {3.716049384927333*^9, 3.716049394725359*^9}, 
   3.716049545284645*^9, {3.716049660809396*^9, 3.716049664983931*^9}, {
   3.71605264457117*^9, 3.7160526455769043`*^9}, {3.7160529878317013`*^9, 
   3.716052989212398*^9}, {3.717253272663273*^9, 3.717253274050931*^9}, {
   3.7180332228902683`*^9, 3.718033254268705*^9}, {3.7180333464265013`*^9, 
   3.71803335856151*^9}, 3.718033406582481*^9, {3.718033676975968*^9, 
   3.718033678100111*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Datatable", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"GenoFreqA", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "NHaplotypes"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "NHaplotypes"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GenoFreqA", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", "1"}], ";", 
     "\[IndentingNewLine]", "Loop"}], ")"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"IntroFreqTotal", ",", " ", "0.05", ",", "0.95", ",", "0.01"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"sp", ",", "0", ",", "0.95", ",", ".01"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7160494650338993`*^9, 3.716049574915853*^9}, {
  3.716050822717165*^9, 3.7160508261254263`*^9}, {3.7160524298571043`*^9, 
  3.716052461930492*^9}, {3.716052707309124*^9, 3.7160527084104147`*^9}, {
  3.7160530035572977`*^9, 3.716053013932357*^9}, {3.716648288840365*^9, 
  3.716648290173499*^9}, {3.7167308093889217`*^9, 3.7167308207719173`*^9}, {
  3.717253457683408*^9, 3.717253467620014*^9}, {3.718033260030468*^9, 
  3.718033271221058*^9}, {3.718033376547855*^9, 3.718033384839334*^9}, {
  3.718033563930882*^9, 3.718033567224142*^9}}],

Cell[BoxData["Datatable"], "Input",
 CellChangeTimes->{3.716052470286347*^9}]
}, Open  ]]
},
Evaluator->"Kernel 7",
WindowSize->{1064, 755},
WindowMargins->{{74, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 138, 2, 64, "Section"],
Cell[563, 19, 27824, 641, 1763, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28424, 665, 97, 1, 64, "Section"],
Cell[28524, 668, 5000, 96, 284, "Input"],
Cell[33527, 766, 1480, 34, 114, "Input"],
Cell[35010, 802, 77, 1, 28, "Input"]
}, Open  ]]
}
]
*)

